<div class="streams-container">
  <h1>RxJS Operators in Angular</h1>

  <!-- Introduction -->
  <div class="section">
    <h2>What Are RxJS Operators?</h2>
    <p>
      Operators are <strong>pure functions</strong> that transform, filter, or
      combine observables. They allow you to manipulate data streams in a
      declarative way.
    </p>
    Common operators:
    <ul>
      <li><code>map</code>: Transform each emitted value.</li>
      <li><code>filter</code>: Only emit values that meet a condition.</li>
      <li>
        <code>debounceTime</code>: Delay emissions until a period of inactivity.
      </li>
      <li><code>take</code>: Only emit the first N values.</li>
      <li>
        <code>tap</code>: Perform side effects without modifying the stream.
      </li>
    </ul>
  </div>

  <!-- Interval Example -->
  <div class="section">
    <h2>Example 1: Interval Stream with Operators</h2>
    <p>
      This example uses <code>interval</code> to emit values every second and
      applies <code>map</code>, <code>filter</code>, and
      <code>take</code> operators.
    </p>

    <div class="controls">
      <button (click)="startIntervalStream()" [disabled]="isIntervalRunning">
        Start Stream
      </button>
      <button (click)="stopIntervalStream()" [disabled]="!isIntervalRunning">
        Stop Stream
      </button>
    </div>

    <div class="output">
      <h3>Operator Pipeline:</h3>
      <ol>
        <li><code>interval(1000)</code>: Emits 0, 1, 2, 3... every second.</li>
        <li>
          <code>tap</code>: Logs raw values →
          <strong>{{ intervalValues }}</strong>
        </li>
        <li>
          <code>map(value => value * 2)</code>: Doubles each value →
          <strong>{{ mappedValues }}</strong>
        </li>
        <li>
          <code>filter(value => value % 3 === 0)</code>: Keeps multiples of 3 →
          <strong>{{ filteredValues }}</strong>
        </li>
        <li>
          <code>take(10)</code>: Takes first 10 values →
          <strong>{{ takenValues }}</strong>
        </li>
      </ol>
    </div>
  </div>

  <!-- Search Example -->
  <div class="section">
    <h2>Example 2: Search with Debounce</h2>
    <p>
      This example uses <code>debounceTime</code> and <code>map</code> to filter
      a list of users based on a search term. The search only triggers after
      500ms of inactivity.
    </p>

    <div class="search-container">
      <input
        type="text"
        [formControl]="searchControl"
        placeholder="Search users..."
        class="search-input"
      />
      <div *ngIf="searchResults.length > 0" class="search-results">
        <h3>Results:</h3>
        <ul>
          <li *ngFor="let result of searchResults">{{ result }}</li>
        </ul>
      </div>
      <div
        *ngIf="searchResults.length === 0 && searchControl.value"
        class="no-results"
      >
        No users found.
      </div>
    </div>
  </div>

  <!-- Mouse Move Example -->
  <div class="section">
    <h2>Example 3: Mouse Move with Throttle</h2>
    <p>
      This example uses <code>fromEvent</code> and <code>debounceTime</code> to
      track mouse movements and reduce the frequency of emissions.
    </p>

    <div class="controls">
      <button
        (click)="startMouseMoveStream()"
        [disabled]="mouseMoveSubscription !== null"
      >
        Start Tracking Mouse
      </button>
      <button
        (click)="stopMouseMoveStream()"
        [disabled]="mouseMoveSubscription === null"
      >
        Stop Tracking Mouse
      </button>
    </div>

    <div class="output">
      <h3>Mouse Positions (throttled):</h3>
      <div *ngIf="mouseMoves.length > 0">
        <ul>
          <li *ngFor="let move of mouseMoves">
            ({{ move.x | number: "1.0-0" }}, {{ move.y | number: "1.0-0" }})
          </li>
        </ul>
      </div>
      <div *ngIf="mouseMoves.length === 0" class="no-results">
        No mouse movements tracked yet.
      </div>
    </div>
  </div>

  <!-- Custom Data Stream Example -->
  <div class="section">
    <h2>Example 4: Custom Data Stream with Map</h2>
    <p>
      This example uses <code>of</code> and <code>map</code> to transform an
      array of user objects into formatted strings.
    </p>

    <div class="controls">
      <button (click)="startUserStream()">Transform Users</button>
    </div>

    <div class="output">
      <h3>Transformed Users:</h3>
      <div *ngIf="userStreamValues.length > 0">
        <ul>
          <li *ngFor="let user of userStreamValues">{{ user }}</li>
        </ul>
      </div>
      <div *ngIf="userStreamValues.length === 0" class="no-results">
        No users transformed yet.
      </div>
    </div>
  </div>

  <!-- Best Practices -->
  <div class="section">
    <h2>Best Practices with Operators</h2>
    <ul>
      <li>
        <strong>Chain operators</strong>: Use the <code>pipe</code> method to
        chain operators in a readable way.
      </li>
      <li>
        <strong>Avoid side effects in operators</strong>: Use
        <code>tap</code> for side effects like logging.
      </li>
      <li>
        <strong>Unsubscribe</strong>: Always clean up subscriptions to avoid
        memory leaks.
      </li>
      <li>
        <strong>Use async pipe in templates</strong>: Automatically handles
        subscriptions in Angular templates.
      </li>
      <li>
        <strong>Error handling</strong>: Provide an <code>error</code> callback
        in <code>subscribe</code>.
      </li>
    </ul>
  </div>
</div>
